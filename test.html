<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>48h Per-User Countdown</title>

  <style>
    :root{
      --accent: #22c55e;               /* brand green */
      --accent-bg: rgba(34,197,94,.12);
      --expired: #f43f5e;              /* red */
      --expired-bg: rgba(244,63,94,.12);
    }

    /* page demo shell (optional) */
    body{
      margin:0; padding:24px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#0b0f14; color:#e5f2ea;
      display:grid; place-items:center;
      min-height: 100dvh;
    }

    /* ===== Timer ===== */
    .vv48-timer{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:12px 16px;
      border-radius:14px;
      background: var(--accent-bg);
      color: var(--accent);
      font-weight: 700;
      line-height: 1;
      box-shadow: 0 8px 24px rgba(0,0,0,.22), inset 0 0 0 1px rgba(255,255,255,.06);
    }
    .vv48-timer strong{
      font-weight: 800;
      letter-spacing:.2px;
    }
    .vv48-timer .block{
      display:inline-flex; gap:6px; align-items: baseline;
    }
    .vv48-timer .val{
      min-width: 2ch;
      text-align: center;
      font-variant-numeric: tabular-nums;
      font-size: clamp(18px, 4vw, 28px);
    }
    .vv48-timer .lbl{
      font-size: 12px; opacity:.85; font-weight:600;
    }
    .vv48-sep{ opacity:.35; padding:0 4px; }

    /* expired state */
    .vv48-timer.vv-expired{
      background: var(--expired-bg);
      color: var(--expired);
    }

    /* small helper row under timer (optional) */
    .vv48-help{
      margin-top:10px; font-size:12px; opacity:.7; text-align:center;
    }

    /* responsive container */
    .wrap{ text-align:center; }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- ===== Timer Markup ===== -->
    <div
      class="vv48-timer"
      id="vv48"
      data-hours="48"            
      aria-live="polite"
      aria-label="Offer countdown timer"
    >
      <strong>Offer ends in</strong>
      <span class="vv48-sep">•</span>

      <span class="block">
        <span class="val dd">00</span><span class="lbl">d</span>
      </span>
      <span class="vv48-sep">:</span>
      <span class="block">
        <span class="val hh">00</span><span class="lbl">h</span>
      </span>
      <span class="vv48-sep">:</span>
      <span class="block">
        <span class="val mm">00</span><span class="lbl">m</span>
      </span>
      <span class="vv48-sep">:</span>
      <span class="block">
        <span class="val ss">00</span><span class="lbl">s</span>
      </span>
    </div>

    <!-- demo tip (optional) -->
    <div class="vv48-help"></div>
  </div>

  <script>
(function(){
  const ROOT = document.getElementById('vv48');
  if(!ROOT) return;

  const HOURS    = +ROOT.dataset.hours || 48;
  const DURATION = HOURS * 60 * 60 * 1000;
  const KEY      = 'vv48_start_at';

  /* ---------- storage helpers (no regex) ---------- */
  function setStart(t){
    try{
      localStorage.setItem(KEY, String(t));
    }catch(e){
      // cookie fallback
      document.cookie = KEY + '=' + encodeURIComponent(String(t))
        + '; max-age=' + Math.ceil(DURATION/1000)
        + '; path=/; SameSite=Lax';
    }
  }
  function getCookie(name){
    if (!document.cookie) return null;
    const parts = document.cookie.split('; ');
    for (const part of parts){
      const eq = part.indexOf('=');
      if (eq < 0) continue;
      const k = part.slice(0, eq);
      if (k === name){
        return decodeURIComponent(part.slice(eq + 1));
      }
    }
    return null;
  }
  function getStart(){
    try{
      const v = localStorage.getItem(KEY);
      if (v !== null) return Number(v);
    }catch(e){}
    const c = getCookie(KEY);
    return c ? Number(c) : null;
  }
  function clearStart(){
    try{ localStorage.removeItem(KEY); }catch(e){}
    document.cookie = KEY + '=; max-age=0; path=/; SameSite=Lax';
  }

  /* ---------- timer logic ---------- */
  let start = getStart();
  if(!start || isNaN(start)){ start = Date.now(); setStart(start); }
  const end = start + DURATION;

  const dd = ROOT.querySelector('.dd'),
        hh = ROOT.querySelector('.hh'),
        mm = ROOT.querySelector('.mm'),
        ss = ROOT.querySelector('.ss');

  const pad = n => String(n).padStart(2,'0');
  let tmo;

  function render(){
    const now = Date.now();
    let left = Math.max(0, end - now);

    if(left <= 0){
      ROOT.classList.add('vv-expired');
      ROOT.innerHTML = '<strong>Offer</strong><span class="vv48-sep">•</span>Expired';
      return;
    }

    const days  = Math.floor(left / 86400000); left -= days  * 86400000;
    const hours = Math.floor(left / 3600000);  left -= hours * 3600000;
    const mins  = Math.floor(left / 60000);    left -= mins  * 60000;
    const secs  = Math.floor(left / 1000);

    if(dd) dd.textContent = pad(days);
    if(hh) hh.textContent = pad(hours);
    if(mm) mm.textContent = pad(mins);
    if(ss) ss.textContent = pad(secs);

    clearTimeout(tmo);
    tmo = setTimeout(render, 1000 - (Date.now() % 1000) + 2);
  }

  // cross-tab sync (optional)
  window.addEventListener('storage', e => { if(e.key === KEY) location.reload(); });

  // expose reset for testing (optional)
  window.vv48Reset = () => { clearStart(); location.reload(); };

  render();
})();
</script>

</body>
</html>
